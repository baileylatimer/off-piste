<section class="email-collection">
  <div class="email-collection__container">
    <div class="email-collection__media-wrapper">
      <!-- Media Content -->
      {% if section.settings.media_type == 'image' %}
        <!-- Desktop Image -->
        {% if section.settings.image_desktop %}
          <div class="email-collection__image email-collection__image--desktop">
            <img 
              src="{{ section.settings.image_desktop | image_url: width: 1920 }}"
              alt="{{ section.settings.heading | escape }}"
              loading="lazy"
              width="{{ section.settings.image_desktop.width }}"
              height="{{ section.settings.image_desktop.height }}"
            >
          </div>
        {% endif %}
        
        <!-- Mobile Image -->
        {% if section.settings.image_mobile %}
          <div class="email-collection__image email-collection__image--mobile">
            <img 
              src="{{ section.settings.image_mobile | image_url: width: 800 }}"
              alt="{{ section.settings.heading | escape }}"
              loading="lazy"
              width="{{ section.settings.image_mobile.width }}"
              height="{{ section.settings.image_mobile.height }}"
            >
          </div>
        {% endif %}
      {% elsif section.settings.media_type == 'video' and section.settings.video_url %}
        <div class="email-collection__video">
          <video 
            autoplay 
            muted 
            loop 
            playsinline
          >
            <source src="{{ section.settings.video_url }}" type="video/mp4">
            Your browser does not support the video tag.
          </video>
        </div>
      {% endif %}

      <!-- Overlay -->
      <div class="email-collection__overlay"></div>

      <!-- Content -->
      <div class="email-collection__content">
        <!-- Top H2 -->
        {% if section.settings.heading != blank %}
          <h2 class="email-collection__heading">{{ section.settings.heading | escape }}</h2>
        {% endif %}
        
        <!-- Bottom Content Group -->
        <div class="email-collection__bottom-content">
          {% if section.settings.subheading != blank %}
            <h4 class="email-collection__subheading">{{ section.settings.subheading | escape }}</h4>
          {% endif %}
          
          {% if section.settings.description != blank %}
            <p class="email-collection__description">{{ section.settings.description | escape }}</p>
          {% endif %}
          
          <!-- Email Signup Form -->
          <div class="email-collection__form-wrapper">
            {%- form 'customer', class: 'email-collection__form' %}
              <div class="email-collection__input-group">
                <label for="EmailInput-{{ section.id }}" class="visually-hidden">
                  Email Address
                </label>
                <input
                  id="EmailInput-{{ section.id }}"
                  class="email-collection__input"
                  type="email"
                  name="contact[email]"
                  autocorrect="off"
                  autocapitalize="off"
                  autocomplete="email"
                  placeholder="Your email"
                  required
                  {% if form.errors %}
                    autofocus
                    aria-invalid="true"
                    aria-describedby="Email-collection__message-error-{{ section.id }}"
                  {% elsif form.posted_successfully? %}
                    aria-describedby="Email-collection__message-success-{{ section.id }}"
                  {% endif %}
                >
                <button class="email-collection__button" type="submit">
                  Notify me
                </button>
              </div>

              {%- if form.errors -%}
                <div
                  id="Email-collection__message-error-{{ section.id }}"
                  class="email-collection__message email-collection__message--error"
                  tabindex="-1"
                >
                  {{- form.errors.translated_fields.email | capitalize }}
                  {{ form.errors.messages.email -}}
                </div>
              {%- endif -%}

              {%- if form.posted_successfully? -%}
                <div
                  id="Email-collection__message-success-{{ section.id }}"
                  class="email-collection__message email-collection__message--success"
                  tabindex="-1"
                >
                  <p class="email-collection__message-text">Thanks for signing up!</p>
                </div>
              {%- endif -%}
            {% endform %}
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<style>
.email-collection {
margin-top: 2em;
}

.email-collection__container {

}

.email-collection__media-wrapper {
  position: relative;
  border-radius: 8px;
  overflow: hidden;
  height: 500px;
  display: flex;
  align-items: stretch;
  background-color: #EDEAE4;
}

.email-collection__image,
.email-collection__video {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  z-index: 1;
}

.email-collection__image img,
.email-collection__video video {
  width: 100%;
  height: 100%;
  object-fit: cover;
  display: block;
}

/* Responsive image display */
.email-collection__image--mobile {
  display: none;
}

.email-collection__image--desktop {
  display: block;
}

@media screen and (max-width: 749px) {
  .email-collection__image--mobile {
    display: block;
  }
  
  .email-collection__image--desktop {
    display: none;
  }
}

.email-collection__overlay {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-color: rgba(0, 0, 0, 0.2);
  z-index: 2;
}

.email-collection__content {
  position: relative;
  z-index: 3;
  width: 100%;
  height: 100%;
  display: flex;
  flex-direction: column;
  justify-content: space-between;
  padding: 2em;
  color: #EDEAE4;
}

.email-collection__heading {
  color: #EDEAE4 !important;
  margin: 0;
  font-family: var(--font-header) !important;
  font-weight: var(--font-weight-semibold) !important;
  text-transform: uppercase !important;
  font-size: 3em;
  line-height: 1.1;
}

.email-collection__bottom-content {
  display: flex;
  flex-direction: column;
  gap: 1em;
  max-width: 400px;
}

.email-collection__subheading {
  color: #EDEAE4 !important;
  margin: 0;
  font-family: var(--font-header) !important;
  font-weight: var(--font-weight-semibold) !important;
  text-transform: uppercase !important;
  font-size: 1.2em;
}

.email-collection__description {
  color: #EDEAE4 !important;
  margin: 0;
  font-family: var(--font-body) !important;
  text-transform: uppercase !important;
  line-height: 1.4;
  font-size: 0.9em;
}

.email-collection__form-wrapper {
  margin-top: 0.5em;
}

.email-collection__form {
  width: 100%;
}

.email-collection__input-group {
  display: flex;
  gap: 0;
  width: 100%;
  max-width: 400px;
}

.email-collection__input {
  flex: 1;
  padding: 12px 16px;
  border: none;
  background-color: rgba(237, 234, 228, 0.9) !important;
  color: #171717;
  font-family: var(--font-body) !important;
  text-transform: uppercase;
  font-size: 0.9em;
  border-radius: 0;
}

.email-collection__input::placeholder {
  color: rgba(23, 23, 23, 0.7);
  text-transform: uppercase;
}

.email-collection__input:hover {
  background-color: rgba(237, 234, 228, 0.9) !important;
}

.email-collection__input:focus {
  outline: none;
  background-color: #EDEAE4 !important;
}

.email-collection__button {
  padding: 12px 20px;
  background-color: #171717;
  color: #EDEAE4;
  border: none;
  font-family: var(--font-button) !important;
  text-transform: uppercase;
  font-size: 0.9em;
  cursor: pointer;
  transition: opacity 0.3s ease;
  border-radius: 0;
  white-space: nowrap;
}

.email-collection__button:hover {
  opacity: 0.8;
}

.email-collection__message {
  margin-top: 1em;
  font-family: var(--font-body) !important;
  text-transform: uppercase;
  font-size: 0.8em;
}

.email-collection__message--error {
  color: #ff6b6b;
}

.email-collection__message--success {
  color: #51cf66;
}

.email-collection__message-text {
  margin: 0;
}

/* Responsive adjustments */
@media screen and (max-width: 749px) {
  .email-collection {
    margin: 20px 0;
  }
  
  .email-collection__media-wrapper {
    height: 700px;
  }
  
  .email-collection__content {
    padding: 1.5em;
  }
  
  .email-collection__heading {
    font-size: 2em;
  }
  
  .email-collection__bottom-content {
    max-width: 100%;
  }
  
  .email-collection__input-group {
    flex-direction: column;
    gap: 8px;
    max-width: 100%;
  }
  
  .email-collection__input,
  .email-collection__button {
    width: 100%;
    padding: 14px 16px;
  }
}
</style>

{% schema %}
{
  "name": "Email Collection",
  "tag": "section",
  "class": "section",
  "settings": [
    {
      "type": "header",
      "content": "Media Settings"
    },
    {
      "type": "select",
      "id": "media_type",
      "label": "Media Type",
      "options": [
        {
          "value": "image",
          "label": "Image"
        },
        {
          "value": "video",
          "label": "Video"
        }
      ],
      "default": "image"
    },
    {
      "type": "image_picker",
      "id": "image_desktop",
      "label": "Desktop Image",
      "info": "Recommended size: 1920x800px"
    },
    {
      "type": "image_picker",
      "id": "image_mobile",
      "label": "Mobile Image",
      "info": "Recommended size: 800x600px"
    },
    {
      "type": "url",
      "id": "video_url",
      "label": "Video URL",
      "info": "Enter the direct URL to your video file (MP4 format recommended)"
    },
    {
      "type": "header",
      "content": "Content Settings"
    },
    {
      "type": "text",
      "id": "heading",
      "label": "Main Heading (H2)",
      "default": "Audio & Control, Built into Your Gear."
    },
    {
      "type": "text",
      "id": "subheading",
      "label": "Subheading (H4)",
      "default": "Get on the list"
    },
    {
      "type": "textarea",
      "id": "description",
      "label": "Description",
      "default": "Be the first to know when preorders drop."
    }
  ],
  "presets": [
    {
      "name": "Email Collection"
    }
  ]
}
{% endschema %}
